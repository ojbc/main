#*
 * Unless explicitly acquired and licensed from Licensor under another license, the contents of
 * this file are subject to the Reciprocal Public License ("RPL") Version 1.5, or subsequent
 * versions as allowed by the RPL, and You may not copy or use this file in either source code
 * or executable form, except in compliance with the terms and conditions of the RPL
 *
 * All software distributed under the RPL is provided strictly on an "AS IS" basis, WITHOUT
 * WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, AND LICENSOR HEREBY DISCLAIMS ALL SUCH
 * WARRANTIES, INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
 * PARTICULAR PURPOSE, QUIET ENJOYMENT, OR NON-INFRINGEMENT. See the RPL for specific language
 * governing rights and limitations under the RPL.
 *
 * http://opensource.org/licenses/RPL-1.5
 *
 * Copyright 2012-2017 Open Justice Broker Consortium
 *#
 <script type="text/javascript">
	  $(function() {

	    //to prevent IE from caching search forms, this has the effect that the input values are not remembered
	    $.ajaxSetup({ cache: false });
	  
	  	oTable = $("#searchResultsTable").DataTable({
  			 pagingType: "full_numbers",
  			 pageLength: 50,
    		 stateSave: true,
    		 fixedHeader: true, 
    		 responsive: true, 
    		 colReorder: true,
			 "columnDefs": [{
		            targets: [ 8 ],
		            searchable: false, 
		            sortable: false
		        } ]
  		});
  		
	  	#if($singleClickForDetail){
			$("#searchResultsTable").on('click', 'tbody tr.clickableIncident', function(){
				$(this).find("a.viewDetails").click();
			});}
		#else{
			$("#searchResultsTable").on('dblclick', 'tbody tr.clickableIncident', function(){
				$(this).find("a.viewDetails").click();
			});}
		#end 
		
		$("#searchResultsTable tr.clickableIncident").on('mouseenter', function(){
             $(this).addClass("incidentHover");
	    }).on('mouseleave', function () {
             $(this).removeClass("incidentHover");
        });
        
		$('#returnToSearchSubmitButton').click (function(){
			$('#filterColumn').removeClass('d-none');
	  		$.get("#springUrl('/incidents/searchForm')",function(data) {
			      $('#portalContent').html(data);
			    }).fail(ojbc.displayFailMessage)
		  	}
		)
		
		$('#newSearchSubmitButton').click (function(){
			ojbc.clearSearchPurposeFields();
			$('#filterColumn').removeClass('d-none');    				    			 
			
	  		$.get("#springUrl('/incidents/searchForm?resetForm=true')",function(data) {
		      $('#portalContent').html(data);
		    }).fail(ojbc.displayFailMessage)
		});
		
        $('#searchResultsTable').on('click', 'a.viewDetails',function() {
            var url = encodeURI(this.href);
            var title = $(this).attr('searchName');
          	$('#detailModal .modal-title').html(title);
			ojbc.showDetailModal(url, 250);
			return false;
        });
        
	  });
	  
 		
  </script>
<div id="searchResultsContainer" class="contentBox" >
	<nav aria-label="breadcrumb">
		<ol class="breadcrumb pb-0">
			<li class="breadcrumb-item"><a href="#springUrl('/portal/index')">Home</a></li>
			<li class="breadcrumb-item"><a href="#" class="incidentSearchLink">Incident Search Form</a></li>
			<li class="breadcrumb-item active" aria-current="page">Incident Search Results</li>
		</ol>
	</nav>
	<div class="card">
		<div class="card-header container-fluid">
		  <div class="row ml-1 h-100">
		    <div class="my-auto font-weight-bold">
		      SEARCH RESULTS: INCIDENT
		    </div>
		    <div class="ml-auto mr-3">
		      <button id="returnToSearchSubmitButton" class="btn btn-sm btn-secondary small">RETURN TO SEARCH</button>
		      <button id="newSearchSubmitButton" class="btn btn-sm btn-secondary ml-auto small" >NEW SEARCH</button>
		    </div>
		  </div>
		</div>
		<div class="card-body">
			#if($informationMessages && $informationMessages!='')
				<div class="alert alert-danger" role="alert" id="informationMessages" >
					$informationMessages
				</div>
			#end
			$searchContent								
		</div>
	</div>
</div>
<div class="modal fade ojbc-modal" id="detailModal" tabindex="-1" role="dialog" aria-labelledby="detailModal" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable" role="document">
	<div class="modal-content">
	  <div class="modal-header">
	  	<h5 class="modal-title"></h5>
	    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	      <span aria-hidden="true">&times;</span>
	    </button>
	  </div>
	  <div class="modal-body">
	  	<div id="modalIframeSpinner"/>
	    <iframe id="modalIframe" src="" style="border:0;overflow:hidden;width:99%" scrolling="no"  frameBorder="0" />
      </div>
	</div>
  </div>
</div>
