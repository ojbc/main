#*
 * Unless explicitly acquired and licensed from Licensor under another license, the contents of
 * this file are subject to the Reciprocal Public License ("RPL") Version 1.5, or subsequent
 * versions as allowed by the RPL, and You may not copy or use this file in either source code
 * or executable form, except in compliance with the terms and conditions of the RPL
 *
 * All software distributed under the RPL is provided strictly on an "AS IS" basis, WITHOUT
 * WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED, AND LICENSOR HEREBY DISCLAIMS ALL SUCH
 * WARRANTIES, INCLUDING WITHOUT LIMITATION, ANY WARRANTIES OF MERCHANTABILITY, FITNESS FOR A
 * PARTICULAR PURPOSE, QUIET ENJOYMENT, OR NON-INFRINGEMENT. See the RPL for specific language
 * governing rights and limitations under the RPL.
 *
 * http://opensource.org/licenses/RPL-1.5
 *
 * Copyright 2012-2017 Open Justice Broker Consortium
 *#
 <script type="text/javascript">
 
  $(function() {
  	
    oTable = $("#personSearchRequestTable").DataTable({
		 "pagingType": "full_numbers",
		 "pageLength": 25,
		 stateSave: true,
		 responsive: true, 
		 colReorder: true,
		 fixedHeader: true, 
		 "language": {
      		"emptyTable": "No Person Search Request Logs Found"
    	 } 
	});
	
	$('.userAuthenticationSearchResults').click (function(){
		oTable.fixedHeader.disable();
		oTable.destroy();
	
       	xhr = $.get("#springUrl('/auditLogs/userAuthenticationSearchResults')",function(data) {
	        $('#portalContent').html(data);
        }).fail(ojbc.displayFailMessage);
	});
	
	$('.ajaxContent').on('show.bs.collapse', function () {
  		var collapseId = $(this).attr("id");
  		var cardBody = $(this).find(".card-body");
  		var url = '/auditLogs/' + collapseId;
       	xhr = $.get("#springUrl('/auditLogs/')" + collapseId,function(data) {
	        cardBody.html(data);
        }).fail(ojbc.displayFailMessage);
  		
	})
	
	$('#collapseOne').on('shown.bs.collapse', function () {
		
	    oTable = $("#personSearchRequestTable").DataTable({
			 "pagingType": "full_numbers",
			 "pageLength": 25,
			 stateSave: true,
			 responsive: true, 
			 colReorder: true,
			 fixedHeader: true, 
			 "language": {
	      		"emptyTable": "No Person Search Request Logs Found"
	    	 } 
		});
		
	})
	
	$('#collapseOne').on('hidden.bs.collapse', function () {
		oTable.fixedHeader.disable();
		oTable.destroy();
	});
	
	$('.ajaxTab').on('show.bs.tab', function () {
		oTable.fixedHeader.disable();
		oTable.destroy();
  		var tabPaneId = $(this).attr("aria-controls");
  		var tabPane = $("#" + tabPaneId);
       	xhr = $.get("#springUrl('/auditLogs/queryRequests')",function(data) {
	        tabPane.html(data);
        }).fail(ojbc.displayFailMessage);
  		
	})
	
  });
    
</script>
	
<div style="padding:10px">
	<nav aria-label="breadcrumb">
		<ol class="breadcrumb">
			<li class="breadcrumb-item"><a href="#springUrl('/portal/index')">Home</a></li>
			<li class="breadcrumb-item"><a href="#" class="auditLink">User Authentication Search Form</a></li>
			<li class="breadcrumb-item"><a href="#" class="userAuthenticationSearchResults">User Authentication Search Results</a></li>
			<li class="breadcrumb-item active" aria-current="page">User Activities</li>
		</ol>
	</nav>

	<table class="table table-striped table-bordered" style="width:100%" id="userDetailTable">
		<thead>
			<tr>
            	<th>USER ACTION</th>
            	<th>FIRST NAME</th>
    	        <th>LAST NAME</th>
	            <th>EMAIL</th>
	            <th>EMPLOYER ORI</th>
	            <th>EMPLOYER NAME</th>
	            <th>TIMESTAMP</th>
            </tr>
		</thead>
		<tbody>
			<tr>
				<td>$!userAuthenticationSearchResponse.userAction</td> 
				<td>$!userAuthenticationSearchResponse.userFirstName</td> 
				<td>$!userAuthenticationSearchResponse.userLastName</td>
				<td>$!userAuthenticationSearchResponse.userEmailAddress</td>
				<td>$!userAuthenticationSearchResponse.employerOri</td>
				<td>$!userAuthenticationSearchResponse.employerName</td>
				<td>$!userAuthenticationSearchResponse.timestamp.format($dateTimeformatter)</td>
            </tr>
		</tbody>
	</table>
	
	<div class="card">
	  <div class="card-header">
	    USER ACTIVITY DETAIL
	  </div>
	  <div class="card-body">
	  	<nav>
		  <div class="nav nav-tabs" id="nav-tab" role="tablist">
		    <a class="nav-item nav-link active" id="nav-home-tab" data-toggle="tab" href="#nav-searchRequests" role="tab" aria-controls="nav-searchRequests" aria-selected="true">SEARCH REQUESTS</a>
		    <a class="nav-item nav-link ajaxTab" id="nav-queryRequests-tab" data-toggle="tab" href="#nav-queryRequests" role="tab" aria-controls="nav-queryRequests" aria-selected="false">QUERY REQUESTS</a>
		  </div>
		</nav>
		<div class="tab-content" id="nav-tabContent">
		  <div class="tab-pane fade show active" id="nav-searchRequests" role="tabpanel" aria-labelledby="nav-home-tab">
			<div id="accordion" class="small">
			  <div class="card">
			    <div class="card-header" id="headingOne">
			        <button class="btn btn-link" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
			          PERSON SEARCH REQUEST
			        </button>
			      </h5>
			    </div>
			
			    <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion">
			      <div class="card-body">
					<table class="searchResultsTable table table-striped table-bordered nowrap" style="width:100%" id="personSearchRequestTable">
						<thead>
							<tr>
								<th>FIRST NAME</th>
								<th>FIRSTNAME QUALIFIER</th>
								<th>LAST NAME</th>
								<th>LAST NAME QUALIFIER</th>
								<th>TIMESTAMP</th>
							</tr>
						</thead>
						<tbody>
					        #foreach($personSearchRequest in $personSearchRequests)
						        <tr title='$!personSearchRequest.personSearchRequestId'>
						        	<td>$!personSearchRequest.firstName</td>
						        	<td>$!personSearchRequest.firstNameQualifierCode</td>
						        	<td>$!personSearchRequest.lastName</td>
						        	<td>$!personSearchRequest.lastNameQualifierCode</td>
						        	<td>$!personSearchRequest.timestamp.format($dateTimeformatter)</td>
					        	</tr>
					        #end
						</tbody>
					</table> 								
			      </div>
			    </div>
			  </div>
			  <div class="card">
			    <div class="card-header" id="headingIncidentSearchRequests">
			      <h5 class="mb-0">
			        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#incidentSearchRequests" aria-expanded="false" aria-controls="incidentSearchRequests">
			          INCIDENT SEARCH REQUEST
			        </button>
			      </h5>
			    </div>
			    <div id="incidentSearchRequests" class="collapse ajaxContent" aria-labelledby="headingIncidentSearchRequests" data-parent="#accordion">
			      <div class="card-body">
			      </div>
			    </div>
			  </div>
			  <div class="card">
			    <div class="card-header" id="headingThree">
			      <h5 class="mb-0">
			        <button class="btn btn-link collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
			          FIREARM SEARCH REQUEST
			        </button>
			      </h5>
			    </div>
			    <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
			      <div class="card-body">
			        Anim pariatur cliche reprehenderit, enim eiusmod high life accusamus terry richardson ad squid. 3 wolf moon officia aute, non cupidatat skateboard dolor brunch. Food truck quinoa nesciunt laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird on it squid single-origin coffee nulla assumenda shoreditch et. Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred nesciunt sapiente ea proident. Ad vegan excepteur butcher vice lomo. Leggings occaecat craft beer farm-to-table, raw denim aesthetic synth nesciunt you probably haven't heard of them accusamus labore sustainable VHS.
			      </div>
			    </div>
			  </div>
			</div>
		  </div>
		  <div class="tab-pane fade" id="nav-queryRequests" role="tabpanel" aria-labelledby="nav-queryRequests-tab">
		  	query requests
		  </div>
		</div>
	  </div>
	</div>
</div>
